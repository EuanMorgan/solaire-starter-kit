## FOUND-001: Environment Validation - COMPLETE

- Installed @t3-oss/env-nextjs@0.13.10 + zod@4.3.5
- Created src/env.ts with createEnv validating:
  - Required: DATABASE_URL, BETTER_AUTH_SECRET, NEXT_PUBLIC_BASE_URL
  - Optional: GITHUB_*, RESEND_*, UPSTASH_*, POSTHOG_*
- Import in next.config.ts triggers build-time validation
- Added typecheck script to package.json
- Verified: missing DATABASE_URL errors correctly
- Made GitHub/Resend/Upstash optional (matches .env.example pattern)

Files changed:
- src/env.ts (new)
- next.config.ts (import env)
- package.json (typecheck script, deps)

## FOUND-002: .env.example Documentation - COMPLETE

- Updated .env.example with all vars from env.ts
- Grouped by category: Database, Auth, GitHub OAuth, Email, Rate Limiting, Analytics
- Added example values + setup URLs for external services
- Added callback URL comment for GitHub OAuth
- Verified all env.ts vars have entries

Files changed:
- .env.example (updated)

## FOUND-003: Site Config - COMPLETE

- Created src/config/site.ts with SiteConfig interface
- Exports siteConfig with name, description, url (from env.NEXT_PUBLIC_BASE_URL), links.github
- Typecheck passes

Files changed:
- src/config/site.ts (new)

## FOUND-004: Layout Metadata - COMPLETE

- Updated layout.tsx to import siteConfig
- Set title/description from siteConfig
- Added openGraph: title, description, url, siteName, type
- Added twitter: card summary_large_image, title, description
- Added icons: favicon.ico, apple-touch-icon.png
- Verified via Playwright: all meta tags render correctly

Files changed:
- src/app/layout.tsx (updated metadata)

## FOUND-005: Tailwind v4 CSS-first - COMPLETE

- Tailwind v4 + @tailwindcss/postcss already installed (create-next-app)
- No tailwind.config.ts (CSS-first in v4)
- postcss.config.mjs uses @tailwindcss/postcss
- Added tw-animate-css@1.4.0 for animations
- Updated globals.css with:
  - @import "tailwindcss" + @import "tw-animate-css"
  - @custom-variant dark (&:is(.dark *)) for class-based dark mode
  - :root + .dark selectors with full shadcn CSS vars in OKLCH
  - @theme inline mapping CSS vars to Tailwind utilities
  - All colors: background, foreground, primary, secondary, muted, accent, destructive, border, input, ring, chart-1-5, sidebar-*
  - Radius vars: --radius-sm/md/lg/xl
- Verified via Playwright: light mode + dark mode render correctly

Files changed:
- src/app/globals.css (complete rewrite)
- package.json (tw-animate-css dep)

## FOUND-006: Security Headers - COMPLETE

- Added headers() async fn to next.config.ts
- X-Frame-Options: DENY - prevents clickjacking
- X-Content-Type-Options: nosniff - prevents MIME sniffing
- Referrer-Policy: strict-origin-when-cross-origin - controls referrer info
- Verified via curl -I: all 3 headers present in response
- Typecheck passes

Files changed:
- next.config.ts (added headers function)

## DB-001: Drizzle ORM Setup - COMPLETE

- Installed drizzle-orm@0.45.1 + postgres@3.4.8 (postgres.js driver)
- Installed drizzle-kit@0.31.8 as devDep
- Created src/db/index.ts with db instance using postgres driver + DATABASE_URL from env
- Created drizzle.config.ts with:
  - dialect: postgresql
  - schema: ./src/db/schema/index.ts
  - tablesFilter using TABLE_PREFIX env var
- Added db scripts: db:push, db:studio, db:generate, db:migrate
- Created placeholder src/db/schema/index.ts for future schemas
- db:push attempts connection (auth fails due to local pg not running - expected)
- Typecheck passes

Files changed:
- src/db/index.ts (new)
- src/db/schema/index.ts (new - placeholder)
- drizzle.config.ts (new)
- package.json (scripts + deps)

## DB-002: Schema Common Helpers - COMPLETE

- Added nanoid@5.1.6 for ID generation
- Created src/db/schema/common.ts with:
  - pgTable: wrapper using pgTableCreator, prepends TABLE_PREFIX from env
  - id(): text primary key with nanoid() default (21-char URL-safe)
  - timestamps(): createdAt/updatedAt with timezone, $onUpdate for updatedAt
- Updated schema/index.ts to export helpers
- Fixed lint: drizzle.config.ts non-null assertion -> type assertion
- Typecheck + lint pass

Files changed:
- src/db/schema/common.ts (new)
- src/db/schema/index.ts (updated exports)
- drizzle.config.ts (lint fix)
- package.json (nanoid dep)

## DB-003: Auth Schema for better-auth - COMPLETE

- Looked up better-auth schema requirements via WebSearch (Context7 quota exceeded)
- Created src/db/schema/auth.schema.ts with:
  - user: id, name, email (unique), emailVerified, image, timestamps
  - session: id, userId (FK), token (unique), expiresAt, ipAddress, userAgent, timestamps
  - account: id, userId (FK), accountId, providerId, accessToken, refreshToken, accessTokenExpiresAt, refreshTokenExpiresAt, scope, idToken, password, timestamps
  - verification: id, identifier, value, expiresAt, timestamps
- Added indexes: user_email, session_user_id, session_token, account_user_id, account_provider, verification_identifier
- Created relations: userRelations (has many sessions/accounts), sessionRelations, accountRelations
- Updated schema/index.ts barrel export
- Typecheck + lint pass
- db:push attempts connection (requires valid DATABASE_URL)

Files changed:
- src/db/schema/auth.schema.ts (new)
- src/db/schema/index.ts (updated exports)

## DB-004: Posts Schema - COMPLETE

- Created src/db/schema/posts.schema.ts with:
  - post: id, title, content, published (boolean), userId (FK to user), timestamps
  - Index on userId for query performance
- Comments explain pgTable wrapper pattern
- Restructured relations to avoid circular deps:
  - Moved all relations to src/db/schema/relations.ts
  - userRelations now includes posts: many(post)
- Typecheck + lint pass

Files changed:
- src/db/schema/posts.schema.ts (new)
- src/db/schema/relations.ts (new - consolidated relations)
- src/db/schema/auth.schema.ts (removed relations - moved to relations.ts)
- src/db/schema/index.ts (updated exports)

## DB-005: Schema Barrel Export - COMPLETE

- Updated src/db/schema/index.ts barrel export
- Exports all tables: user, session, account, verification, post
- Exports all relations: userRelations, sessionRelations, accountRelations, postRelations
- Exports common helpers: id, pgTable, timestamps
- import * as schema from '@/db/schema' works
- Typecheck passes

Files changed:
- src/db/schema/index.ts (updated)

## AUTH-001: better-auth Core with Drizzle Adapter - COMPLETE

- Installed better-auth@1.4.10
- Created src/lib/auth.ts with:
  - betterAuth configured with drizzleAdapter
  - provider: "pg" for PostgreSQL
  - schema mapped: user, session, account, verification tables
  - baseURL from env.NEXT_PUBLIC_BASE_URL
  - secret from env.BETTER_AUTH_SECRET
- Updated src/db/index.ts to pass schema to drizzle() for relations support
- Typecheck passes

Files changed:
- src/lib/auth.ts (new)
- src/db/index.ts (added schema)
- package.json (better-auth dep)

## AUTH-002: Email/Password Auth Plugin - COMPLETE

- Added emailAndPassword plugin to src/lib/auth.ts
- Set enabled: true
- Password hashing handled automatically by better-auth (scrypt default)
- Comment notes email verification can be enabled later via emailVerification config
- Typecheck passes

Files changed:
- src/lib/auth.ts (added emailAndPassword config)

## AUTH-003: Magic Link Auth Plugin - COMPLETE

- Added magicLink plugin from better-auth/plugins
- Set expiresIn: 600 (10 minutes)
- sendMagicLink placeholder logs to console - will wire to Resend in EMAIL-003
- Typecheck + lint pass

Files changed:
- src/lib/auth.ts (added magicLink plugin)

## AUTH-004: GitHub OAuth Provider - COMPLETE

- Added socialProviders.github to src/lib/auth.ts
- Uses GITHUB_CLIENT_ID + GITHUB_CLIENT_SECRET from env (optional)
- Conditional spread: only adds github if both env vars present
- Comment documents callback URL: {baseURL}/api/auth/callback/github
- Typecheck passes

Files changed:
- src/lib/auth.ts (added socialProviders)

## AUTH-005: Auth Client for client-side auth - COMPLETE

- Created src/lib/auth-client.ts with "use client" directive
- createAuthClient from better-auth/react
- Added magicLinkClient plugin for signIn.magicLink support
- Exports: authClient, useSession, signIn, signOut, signUp
- signIn.social and signIn.magicLink available via signIn export
- Typecheck + lint pass

Files changed:
- src/lib/auth-client.ts (new)

## AUTH-006: Auth API Route - COMPLETE

- Created src/app/api/auth/[...all]/route.ts
- Uses toNextJsHandler from better-auth/next-js (not auth.handler)
- Exports GET and POST handlers
- Note: better-auth uses /api/auth/get-session (not /session)
- Verified: GET /api/auth/get-session returns null (no session)
- Typecheck passes

Files changed:
- src/app/api/auth/[...all]/route.ts (new)

## TEST-001: Vitest Setup - COMPLETE

- Installed vitest@4.0.16 + @testing-library/react + @testing-library/jest-dom + jsdom + @vitejs/plugin-react
- Created vitest.config.ts with React plugin, jsdom env, @ alias
- Created src/test/setup.ts importing jest-dom matchers
- Added scripts: test, test:watch, test:coverage
- All tests pass

Files changed:
- vitest.config.ts (new)
- src/test/setup.ts (new)
- package.json (scripts + devDeps)

## AUTH-007: Auth Validation Schemas - COMPLETE

- Created src/lib/validations/auth.ts with Zod v4
- loginSchema: email (z.email), password (min 8)
- signupSchema: name, email, password, confirmPassword w/ refine for match
- Password strength: min 8, uppercase required, number required
- magicLinkSchema: email only
- Exported types: LoginInput, SignupInput, MagicLinkInput
- Created src/lib/validations/__tests__/auth.test.ts with 10 tests
- Tests: invalid email, short password, no uppercase, no number, mismatch, valid inputs
- Typecheck + lint + all tests pass

Files changed:
- src/lib/validations/auth.ts (new)
- src/lib/validations/__tests__/auth.test.ts (new)

## AUTH-008: Auth Proxy for Route Protection - COMPLETE

- Next.js 16 uses proxy.ts (not middleware.ts) per official docs
- Uses getSessionCookie from better-auth/cookies for cookie-only check (fast, no DB call)
- Created src/proxy.ts with:
  - Protected routes: /dashboard, /settings -> redirect to /login if no session
  - Auth routes: /login, /signup -> redirect to /dashboard if session exists
  - Matcher config for all protected + auth routes
- Created placeholder pages: /login, /signup, /dashboard, /settings
- Verified via Playwright MCP:
  - /dashboard unauthenticated -> redirects to /login
  - /settings unauthenticated -> redirects to /login
  - /login renders for unauthenticated users
- Typecheck + lint + tests pass

Files changed:
- src/proxy.ts (new)
- src/app/login/page.tsx (new - placeholder)
- src/app/signup/page.tsx (new - placeholder)
- src/app/dashboard/page.tsx (new - placeholder)
- src/app/settings/page.tsx (new - placeholder)

## API-001: tRPC Core Setup - COMPLETE

- Installed @trpc/server@11.8.1 + @trpc/client@11.8.1 + @trpc/tanstack-react-query@11.8.1 + @tanstack/react-query@5.90.16 + superjson@2.2.6
- Created src/trpc/init.ts with:
  - createTRPCContext using React cache() for request deduplication
  - Session fetched from better-auth via auth.api.getSession
  - Uses superjson transformer for Date/BigInt/Map/Set serialization
  - createTRPCRouter, createCallerFactory exports
  - baseProcedure (public, no auth)
  - protectedProcedure (throws UNAUTHORIZED if no session)
- Typecheck passes

Files changed:
- src/trpc/init.ts (new)
- package.json (deps)

## API-002: tRPC Logging Middleware - COMPLETE

- Added loggingMiddleware to src/trpc/init.ts
- Logs path, type, duration for each procedure call
- Dev: info level with sanitized input; Prod: debug level (silent)
- sanitizeInput() redacts password/confirmPassword/token/secret fields
- Uses getRawInput() (async fn) per tRPC v11 middleware API
- baseProcedure now uses logging middleware
- protectedProcedure extends baseProcedure (inherits logging)
- Typecheck + lint + tests pass

Files changed:
- src/trpc/init.ts (updated)

## API-003: Rate Limiting with Upstash - COMPLETE

- Installed @upstash/ratelimit@2.0.7 + @upstash/redis@1.36.1
- Created src/lib/rate-limit.ts with:
  - Ratelimit configured with slidingWindow(10, "10 s")
  - Redis client using UPSTASH_REDIS_REST_URL + TOKEN from env
  - Returns null if env vars not set (graceful skip)
  - Custom prefix "@solaire/ratelimit"
- Updated src/trpc/init.ts:
  - Context now extracts IP from x-forwarded-for header
  - Added rateLimitedProcedure middleware
  - Rate limits by user ID (if authenticated) or IP address
  - Throws TOO_MANY_REQUESTS on limit exceeded
  - Skips gracefully if ratelimit is null (no Upstash configured)
- Typecheck + lint + tests pass

Files changed:
- src/lib/rate-limit.ts (new)
- src/trpc/init.ts (updated - added IP to context, rateLimitedProcedure)
- package.json (deps)

## API-004 through API-010: tRPC Full Setup - COMPLETE

Implemented complete tRPC v11 with @trpc/tanstack-react-query integration:

- API-004: src/trpc/query-client.ts - makeQueryClient with SSR config, superjson serialize/deserialize, 30s staleTime, retry skips UNAUTHORIZED
- API-005: src/trpc/client.tsx - TRPCReactProvider with createTRPCContext, useTRPC hook, httpBatchLink, ReactQueryDevtools in dev
- API-006: src/trpc/server.tsx - createTRPCOptionsProxy, HydrateClient component, prefetch helper, caller for direct server calls
- API-007: src/trpc/routers/user.ts - me/updateProfile/deleteAccount procedures with tests
- API-008: src/trpc/routers/_app.ts - appRouter merging userRouter, exports AppRouter type
- API-009: src/app/api/trpc/[trpc]/route.ts - fetchRequestHandler for GET/POST
- API-010: src/trpc/index.ts - RouterInputs/RouterOutputs type exports

Key patterns:
- v11 uses createTRPCContext from @trpc/tanstack-react-query (not @trpc/react-query)
- useTRPC hook + TRPCProvider pattern for client components
- createTRPCOptionsProxy for server-side prefetching
- HydrateClient wraps dehydrated state for SSR

Tests:
- src/trpc/routers/__tests__/user.test.ts - 6 tests covering procedure behavior
- All 16 tests pass (10 auth validation + 6 user router)

Verified: GET /api/trpc/user.me returns 401 UNAUTHORIZED (correct behavior)

Files changed:
- src/trpc/query-client.ts (new)
- src/trpc/client.tsx (new)
- src/trpc/server.tsx (new)
- src/trpc/index.ts (new)
- src/trpc/routers/user.ts (new)
- src/trpc/routers/_app.ts (new)
- src/trpc/routers/__tests__/user.test.ts (new)
- src/app/api/trpc/[trpc]/route.ts (new)
- package.json (server-only, @tanstack/react-query-devtools deps)

## API-011: Common Validation Schemas - COMPLETE

- Created src/lib/validations/common.ts with:
  - paginationSchema: page (min 1), limit (min 1, max 100)
  - idSchema: id (non-empty string)
  - Exported types: PaginationInput, IdInput
- Created src/lib/validations/index.ts barrel export
- Exports all schemas + types from auth.ts and common.ts
- Typecheck + lint + tests pass

Files changed:
- src/lib/validations/common.ts (new)
- src/lib/validations/index.ts (new)

## API-012: Health Check Endpoint - COMPLETE

- Created src/app/api/health/route.ts
- GET handler returns JSON: status, timestamp, database
- Pings DB with `SELECT 1` via drizzle sql template
- Returns 200 + "connected" on success, 503 + "unreachable" on failure
- Verified: endpoint returns 503 when DB not running (correct)
- Typecheck + lint + tests pass

Files changed:
- src/app/api/health/route.ts (new)

## EMAIL-001: Resend Email Service - COMPLETE

- Installed resend@6.7.0
- Created src/modules/email/server/email.service.ts with:
  - Resend client initialized from RESEND_API_KEY (optional, null if not set)
  - sendEmail() function accepting to, subject, react params
  - Uses FROM_EMAIL from env as sender
  - Graceful skip if RESEND_API_KEY or FROM_EMAIL not configured
- Typecheck + lint + tests pass

Files changed:
- src/modules/email/server/email.service.ts (new)
- package.json (resend dep)

## EMAIL-002: React Email Templates - COMPLETE

- Installed @react-email/components@1.0.4
- Created src/modules/email/ui/verification-email.tsx:
  - verificationUrl prop, Html/Head/Body/Container/Text/Button/Link
  - Inline styles for email client compat, responsive container
- Created src/modules/email/ui/reset-password-email.tsx:
  - resetUrl prop, same component structure
  - 1 hour expiry note
- Created src/modules/email/ui/welcome-email.tsx:
  - userName prop, simpler structure (no CTA button)
- Created barrel export: src/modules/email/ui/index.ts
- Typecheck + tests pass

Files changed:
- src/modules/email/ui/verification-email.tsx (new)
- src/modules/email/ui/reset-password-email.tsx (new)
- src/modules/email/ui/welcome-email.tsx (new)
- src/modules/email/ui/index.ts (new)
- package.json (@react-email/components dep)

## EMAIL-003: Wire Emails to better-auth - COMPLETE

- Created src/modules/email/ui/magic-link-email.tsx template
- Updated src/lib/auth.ts with email callbacks:
  - emailVerification.sendVerificationEmail -> VerificationEmail
  - emailAndPassword.sendResetPassword -> ResetPasswordEmail
  - magicLink.sendMagicLink -> MagicLinkEmail
- All callbacks use void sendEmail() to prevent timing attacks
- Typecheck + tests pass

Files changed:
- src/modules/email/ui/magic-link-email.tsx (new)
- src/modules/email/ui/index.ts (updated export)
- src/lib/auth.ts (wired email callbacks)

## UI-001: Install Core shadcn Components - COMPLETE

- Ran bunx shadcn@latest init --yes --defaults (New York style, Tailwind v4 detected)
- Added button, input, label, card components via bunx shadcn@latest add
- Created src/lib/utils.ts with cn() helper (clsx + tailwind-merge)
- Created components.json config for shadcn CLI
- Installed deps: class-variance-authority, clsx, tailwind-merge, lucide-react, @radix-ui/react-slot, @radix-ui/react-label
- Fixed Biome lint issues in generated files (import order, semicolons)
- Verified via Playwright: all components render correctly (tested Button variants, Input, Label, Card)
- Typecheck + lint + tests pass

Files changed:
- src/components/ui/button.tsx (new)
- src/components/ui/input.tsx (new)
- src/components/ui/label.tsx (new)
- src/components/ui/card.tsx (new)
- src/lib/utils.ts (new)
- components.json (new)
- package.json (deps)

## UI-002: Add Loading State to Button - COMPLETE

- Added loading prop to ButtonProps interface
- Import Loader2 from lucide-react for spinner icon
- When loading=true: shows Loader2 with animate-spin before children
- aria-busy={loading} for accessibility
- disabled={loading || disabled} prevents clicks while loading
- Verified via Playwright: spinner renders, button disabled in all variants
- Typecheck + lint + tests pass

Files changed:
- src/components/ui/button.tsx (updated)

## UI-003: Install Form Components with react-hook-form - COMPLETE

- Installed react-hook-form@7.70.0 + @hookform/resolvers@5.2.2
- Added shadcn form component via `bunx shadcn@latest add form --overwrite`
- Form component provides: Form, FormField, FormItem, FormLabel, FormControl, FormDescription, FormMessage
- useFormField hook for accessing field state/errors
- Works with zodResolver from @hookform/resolvers/zod
- Applied Biome lint fixes to shadcn-generated files
- Typecheck + lint + all 16 tests pass

Files changed:
- src/components/ui/form.tsx (new)
- src/components/ui/button.tsx (updated by shadcn)
- src/components/ui/label.tsx (updated by shadcn)
- package.json (react-hook-form, @hookform/resolvers deps)

## UI-004: Install Dialog Components - COMPLETE

- Installed shadcn dialog via `bunx shadcn@latest add dialog`
- Installed shadcn alert-dialog via `bunx shadcn@latest add alert-dialog --overwrite`
- Dialog: DialogTrigger, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter, DialogClose
- AlertDialog: AlertDialogTrigger, AlertDialogContent, AlertDialogHeader, AlertDialogTitle, AlertDialogDescription, AlertDialogFooter, AlertDialogAction, AlertDialogCancel
- Applied Biome lint fixes (semicolons, import type, import order)
- Verified via Playwright: both Dialog and AlertDialog render + function correctly
- Typecheck + lint + tests pass

Files changed:
- src/components/ui/dialog.tsx (new)
- src/components/ui/alert-dialog.tsx (new)
- src/components/ui/button.tsx (updated by shadcn)
- package.json (@radix-ui/react-dialog, @radix-ui/react-alert-dialog deps)

## UI-005: Install Dropdown and Select - COMPLETE

- Installed shadcn dropdown-menu via `bunx shadcn@latest add dropdown-menu`
- Installed shadcn select via `bunx shadcn@latest add select`
- DropdownMenu: DropdownMenuTrigger, DropdownMenuContent, DropdownMenuItem, DropdownMenuCheckboxItem, DropdownMenuRadioGroup, DropdownMenuRadioItem, DropdownMenuLabel, DropdownMenuSeparator, DropdownMenuShortcut, DropdownMenuSub, DropdownMenuSubTrigger, DropdownMenuSubContent
- Select: SelectTrigger, SelectContent, SelectItem, SelectGroup, SelectLabel, SelectSeparator, SelectScrollUpButton, SelectScrollDownButton, SelectValue
- Applied Biome lint fixes (import type, semicolons, import order)
- Typecheck + lint + tests pass

Files changed:
- src/components/ui/dropdown-menu.tsx (new)
- src/components/ui/select.tsx (new)
- package.json (@radix-ui/react-dropdown-menu, @radix-ui/react-select deps)

## UI-006: Install Additional Form Controls - COMPLETE

- Installed textarea, checkbox, tabs via `bunx shadcn@latest add textarea checkbox tabs`
- Textarea: simple text input with auto-sizing
- Checkbox: uses @radix-ui/react-checkbox with CheckIcon
- Tabs: TabsList, TabsTrigger, TabsContent for tabbed interfaces
- Applied Biome lint fixes (import type, semicolons, import order)
- Typecheck + lint + tests pass

Files changed:
- src/components/ui/textarea.tsx (new)
- src/components/ui/checkbox.tsx (new)
- src/components/ui/tabs.tsx (new)
- package.json (@radix-ui/react-checkbox, @radix-ui/react-tabs deps)
